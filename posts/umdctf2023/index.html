<!doctype html><html lang="en"
   data-mode="dark">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>UMDCTF 2023 | farmansk&#39;s Blog</title><link rel="apple-touch-icon" href="https://farmansk.github.io/images/favicons/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="https://farmansk.github.io/images/favicons/favicon-32x32.png" sizes="32x32" type="image/png">
<link rel="icon" href="https://farmansk.github.io/images/favicons/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="https://farmansk.github.io/images/favicons/manifest.json">
<link rel="icon" href="https://farmansk.github.io/images/favicons/favicon.ico">
<meta name="keywords" content="" />
<meta name="description" content=" My approch towards the CTF challenges" />

<meta itemprop="name" content="UMDCTF 2023">
<meta itemprop="description" content=" My approch towards the CTF challanges "><meta itemprop="datePublished" content="2022-08-17T07:34:48+08:30" />
<meta itemprop="dateModified" content="2022-08-17T07:34:48+08:30" />
<meta itemprop="wordCount" content="41"><meta itemprop="image" content='https://farmansk.github.io/posts/umdctf2023/images/_card.png'>
<meta itemprop="keywords" content="Misc," /><meta property="og:title" content="UMDCTF 2023" />
<meta property="og:description" content=" My approch towards the CTF challanges " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://farmansk.github.io/posts/umdctf2023/" /><meta property="og:image" content='https://farmansk.github.io/posts/umdctf2023/images/_card.png' /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-17T07:34:48+08:30" />
<meta property="article:modified_time" content="2022-08-17T07:34:48+08:30" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:image" content='https://farmansk.github.io/posts/umdctf2023/images/_card.png'/>

<meta name="twitter:title" content="UMDCTF 2023"/>
<meta name="twitter:description" content=" My approch towards the CTF challanges "/>
<meta name="twitter:site" content="@farmansk"/>
<link rel="preload" href="https://farmansk.github.io/css/bundle.min.fcd024e77e7ca8dc30926e1b5389582b45bdb44482ee20d1ae3aae2c00de9817.css" integrity="sha256-/NAk5358qNwwkm4bU4lYK0W9tESC7iDRrjquLADemBc=" crossorigin="anonymous" as="style" onload="this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://farmansk.github.io/css/bundle.min.fcd024e77e7ca8dc30926e1b5389582b45bdb44482ee20d1ae3aae2c00de9817.css" integrity="sha256-/NAk5358qNwwkm4bU4lYK0W9tESC7iDRrjquLADemBc=" crossorigin="anonymous"></noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Consolas" type="text/css" media="all" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fira+Code" type="text/css" media="all" />
<style>
 body { font-family: 'Consolas'; }
 code { font-family: 'Fira Code'; }
 code { tab-size: 4; }
</style></head>
  <body><script src="https://farmansk.github.io/js/bootstrap.min.062c2e66b557cb779d59cedff7e0cc76e84beb665a1076e474e87d940be44245.js" integrity="sha256-BiwuZrVXy3edWc7f9&#43;DMduhL62ZaEHbkdOh9lAvkQkU=" crossorigin="anonymous"></script><header><nav class="navbar top-app-bar top-app-bar-expand-lg fixed-top">
  <div class="container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <i class="fas fa-bars"></i>
    </button><a class="navbar-brand me-3" href="https://farmansk.github.io/">farmansk&#39;s Blog
    </a>
    <button class="navbar-social-share" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSocialShare"
  aria-controls="offcanvasSocialShare" aria-label="Toggle social share">
  <i class="fas fa-share-alt"></i>
</button>

<div class="offcanvas offcanvas-bottom surface" tabindex="-1" id="offcanvasSocialShare" aria-labelledby="offcanvasSocialShare">
  <div class="offcanvas-header">
    <h3 class="offcanvas-title">Share</h3>
    <button type="button" class="btn btn-sm btn-outline-primary" data-bs-dismiss="offcanvas" aria-label="Close">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div class="offcanvas-body">
    <a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Twitter Share Button"
      target="_blank" href="https://twitter.com/intent/tweet?title=UMDCTF%202023&url=https%3a%2f%2ffarmansk.github.io%2fposts%2fumdctf2023%2f">
      <i class="fab fa-fw fa-twitter"></i> Twitter
    </a>
    <a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Facebook Share Button"
      target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ffarmansk.github.io%2fposts%2fumdctf2023%2f">
      <i class="fab fa-fw fa-facebook-f"></i> Facebook
    </a>
  </div>
</div>
    <button class="navbar-settings" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSettings"
  aria-controls="offcanvasSettings" aria-label="Toggle settings">
  <i class="fas fa-ellipsis-v"></i>
</button>

<div class="offcanvas offcanvas-end surface h-100" tabindex="-1" id="offcanvasSettings" aria-labelledby="offcanvasSettings">
  <div class="offcanvas-header">
    <h3 class="offcanvas-title">Settings</h3>
    <button type="button" class="btn btn-sm btn-outline-primary" data-bs-dismiss="offcanvas" aria-label="Close">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div class="offcanvas-body">



<section class="setting">
  <form class="font-size-switcher-form row">
    <div class="col-auto">
      <label for="fontSize" class="form-label"><i class="fas fa-fw fa-font"></i> Font Size</label>
    </div>
    <div class="col-auto ms-auto">
      <input type="range" class="form-range" min="-2" max="2" id="fontSize">
    </div>
  </form>
</section>


<section class="setting palettes">
  <form class="row">
    <div class="col-auto">
      <label><i class="fas fa-fw fa-palette"></i> Palette</label>
    </div>
    <div class="col-auto ms-auto">
      <a id="btnPalette" class="btn btn-sm btn-outline-primary" role="button" aria-label="palettePicker">
        <i class="fas fa-eye-dropper"></i>
      </a>
    </div>
  </form>
  <div class="mt-2 d-flex visually-hidden" id="palettePicker"><button type="button" id="palette-blue" aria-label="Blue"
        class="btn btn-sm palette" data-palette="blue">
      </button><button type="button" id="palette-blue-gray" aria-label="Blue Gray"
        class="btn btn-sm palette" data-palette="blue-gray">
      </button><button type="button" id="palette-brown" aria-label="Brown"
        class="btn btn-sm palette" data-palette="brown">
      </button><button type="button" id="palette-cyan" aria-label="Cyan"
        class="btn btn-sm palette" data-palette="cyan">
      </button><button type="button" id="palette-green" aria-label="Green"
        class="btn btn-sm palette" data-palette="green">
      </button><button type="button" id="palette-indigo" aria-label="Indigo"
        class="btn btn-sm palette" data-palette="indigo">
      </button><button type="button" id="palette-orange" aria-label="Orange"
        class="btn btn-sm palette" data-palette="orange">
      </button><button type="button" id="palette-pink" aria-label="Pink"
        class="btn btn-sm palette" data-palette="pink">
      </button><button type="button" id="palette-purple" aria-label="Purple"
        class="btn btn-sm palette" data-palette="purple">
      </button><button type="button" id="palette-red" aria-label="Red"
        class="btn btn-sm palette" data-palette="red">
      </button><button type="button" id="palette-teal" aria-label="Teal"
        class="btn btn-sm palette" data-palette="teal">
      </button><button type="button" id="palette-yellow" aria-label="Yellow"
        class="btn btn-sm palette" data-palette="yellow">
      </button></div>
</section>
</div>
</div>

    <div class="collapse navbar-collapse" tabindex="-1" id="navbarSupportedContent" aria-labelledby="navbarSupportedContent">
      
      <ul class="navbar-nav ms-auto"><li class="nav-item">
          <a class="nav-link" href="https://farmansk.github.io/archives/">
            <i class="fas fa-fw fa-file-archive"></i>Archives
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="https://farmansk.github.io/categories/">
            <i class="fas fa-fw fa-folder"></i>Categories
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="https://farmansk.github.io/tags/">
            <i class="fas fa-fw fa-tags"></i>Tags
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="https://farmansk.github.io/series/">
            <i class="fas fa-fw fa-columns"></i>Series
          </a>
        </li></ul>
    </div>
  </div>
</nav>
</header>
<main role="main" class="container">
      <div class="row content">
<div class="col-lg-8">
  <div class="container"><nav class="row card component" aria-label="breadcrumb">
  <div class="card-body">
    <ol class="breadcrumb "><li class="breadcrumb-item"><a href="https://farmansk.github.io/">Home</a></li><li class="breadcrumb-item"><a href="https://farmansk.github.io/posts/">Posts</a></li><li class="breadcrumb-item active">UMDCTF 2023</li></ol>
  </div>
</nav>    <article class="row card component mb-4 post"><div class="post-panel-wrapper">
  <div class="d-flex flex-column component rounded post-panel">
    
    <a id="sidebarToggler" class="action d-none d-lg-block" role="button">
  <i class="fas fa-fw fa-expand-alt" data-fa-transform="rotate-45"></i>
</a>
  
    

    
    
    
    
  </div>
</div>
<div class="card-body">
        <h1 class="card-title my-3">UMDCTF 2023
</h1><div class="post-meta"><span class="post-date" title="created on">
    <i class="fas fa-fw fa-calendar-alt"></i>Aug 17, 2022
  </span><span class="post-reading-time" title="reading time">
    <i class="fas fa-fw fa-coffee"></i>1 min read
  </span><a href="https://farmansk.github.io/categories/ctf/" class="badge rounded-pill text-white bg-primary post-taxonomy">CTF</a><a href="https://farmansk.github.io/categories/writeups/" class="badge rounded-pill text-white bg-primary post-taxonomy">WriteUps</a><a href="https://farmansk.github.io/categories/security/" class="badge rounded-pill text-white bg-primary post-taxonomy">Security</a><a href="https://farmansk.github.io/tags/misc/" class="badge rounded-pill text-white bg-primary post-taxonomy">Misc</a></div>
<div class="post-content mb-3"><p>Sup?!</p>
<p>Hey, there! After a bit gap, I’m back with UMD CTF. I played this CTF along with Invaders0x1 team.
I only remember few Crypto challenges that I solved because all others were basic stuff.</p>
<h3 id="Crypto">Crypto</h3>
<h5>BulbEuler</h5>
<p>The challenge provided a sage file and an output file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sage" data-lang="sage">
<span class="line"><span class="c1"># This is the code that was given in bulb.sage</span></span>
<span class="line"><span class="kn">FLAG</span> <span class="o">=</span> <span class="nb">open</span>(<span class="s1">'flag.txt'</span>, <span class="s1">'r'</span>).<span class="n">read</span>()</span>

<span class="line"><span class="kn">flag_bytes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="kn">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="kn">FLAG</span><span class="p">]</span></span>
<span class="line"><span class="kn">flag_bits</span> <span class="o">=</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">f</span><span class="s1">{num:08b}</span></span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="kn">flag_bytes</span><span class="p">])</span></span>

<span class="line"><span class="kn">p</span> <span class="o">=</span> <span class="n">random_prime</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">256</span><span class="p">)</span></span>
<span class="line"><span class="kn">G</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="kn">p</span><span class="p">,</span> <span class="n">modulus</span><span class="o">=</span><span class="s1">"primitive"</span><span class="p">)</span></span>
<span class="line"><span class="kn">g</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span></span>
<span class="line"><span class="kn">m</span> <span class="o">=</span> <span class="kn">p</span><span class="o">-</span><span class="mi">1</span></span>

<span class="line"><span class="nb">print</span><span class="p">(</span><span class="s1">f'p: {p}'</span><span class="p">)</span></span>
<span class="line"><span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="kn">flag_bits</span><span class="p">:</span></span>
    <span class="line"><span class="n">x</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span></span>
    <span class="line"><span class="k">if</span> <span class="n">bit</span> <span class="o">==</span> <span class="s1">'1'</span><span class="p">:</span></span>
        <span class="line"><span class="n">y</span> <span class="o">=</span> <span class="n">m</span><span class="o">-</span><span class="n">x</span></span>
    <span class="line"><span class="k">else</span><span class="p">:</span></span>
        <span class="line"><span class="n">y</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span></span>

    <span class="line"><span class="nb">print</span><span class="p">(</span><span class="n">f'{g</span><span class="o">^</span><span class="n">x</span><span class="p">},</span> <span class="n">g</span><span class="o">^</span><span class="n">y</span><span class="p">)'</span><span class="p">)</span></span>
</code></pre></div>
<p>The output file had the p value. It is:</p>
<code>p = 6596997572802685744626960256235787019476434707654191935397530271983648431547</code>
<p>So, I used sage to get the value of 'g'. It was:</p>
<code>g = 2</code>
<p>As the g is prime, we can use Fermat's Little theorem here.</p>
<p><code>
    If p is prime, for every integer a:
        pow(a, p) = a mod p
    and, if p is prime and a is an integer coprime with p:
        pow(a, p-1) = 1 mod p
</code></p>
<p>If the bit is 1:</p>
<p><code>=> y = m - x</code></p>
<p><code>=> y + x = m</code></p>
<p><code>=> y + x = p - 1</code></p>
<p><code>=> g^(y + x) = g^(p - 1)</code></p>
<p><code>=> g^y * g^x = g^(p - 1)</code></p>
<p><code>=> g^y * g^x = 1 mod p</code></p>

<p>So, I used this to write the solution.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py">
<span class="line"><span class="kn">arr</span> <span class="o">=</span> <span class="p">[</span><span class="c1"># Given g^x, g^y output here</span>]</span>
<span class="line"><span class="kn">p</span> <span class="o">=</span> <span class="mi">6596997572802685744626960256235787019476434707654191935397530271983648431547</span></span>
<span class="line"><span class="kn">m</span> <span class="o">=</span> <span class="mi">p - 1</span></span>
<span class="line"></span>
<span class="line"><span class="kn">flag_bits</span> <span class="o">=</span> <span class="s1">''</span></span>
<span class="line"><span class="kn">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span></span>
    <span class="line"><span class="c1"># print(arr[i], arr[i+1])</span></span>
    <span class="line"><span class="k">if</span> <span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="p">(</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span><span class="o">%</span> <span class="n">p</span><span class="p">)):</span></span>
        <span class="line"><span class="n">flag_bits</span> <span class="o">+=</span> <span class="s1">'1'</span></span>
    <span class="line"><span class="k">else</span><span class="p">:</span></span>
        <span class="line"><span class="n">flag_bits</span> <span class="o">+=</span> <span class="s1">'0'</span></span>
    <span class="line"><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">flag_bits</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span></span>
        <span class="line"><span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">flag_bits</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">end</span> <span class="o">=</span> <span class="s1">''</span><span class="p">)</span></span>
        <span class="line"><span class="n">flag_bits</span> <span class="o">=</span> <span class="s1">''</span></span>
</code></pre></div>
<p>UMDCTF{I_d0nt_th1nk_bulby_!s_th3_n3xt_3ul3r_tbh}</p>

<h5>Reduce Thyself</h5>
<p>This challenge is similar to the challenge No Padding in picoCTF. This challenge is a netcat based challenge provided with the python file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python">
  <span class="kn">import</span> <span class="nn">socket</span>
  <span class="kn">import</span> <span class="nn">random</span>
  <span class="kn">import</span> <span class="nn">threading</span>
  <span class="kn">from</span> <span class="nn">_thread</span> <span class="kn">import</span> <span class="o">*</span>
  <span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span> <span class="kn">as</span> <span class="n">l2b</span><span class="o">,</span> <span class="n">bytes_to_long</span> <span class="kn">as</span> <span class="n">b2l</span><span class="o">,</span> <span class="n">getPrime</span><span class="o">,</span> <span class="n">isPrime</span><span class="o">,</span> <span class="n">inverse</span>
  <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">gcd</span>
  <span class="kn">from</span> <span class="nn">binascii</span> <span class="kn">import</span> <span class="n">hexlify</span><span class="o">,</span> <span class="n">unhexlify</span>
  
  <span class="n">HOST</span> <span class="o">=</span> <span class="s1">'0.0.0.0'</span>  <span class="c1"># Standard loopback interface address (localhost)</span>
  <span class="n">PORT</span> <span class="o">=</span> <span class="mi">60003</span>        <span class="c1"># Port to listen on (non-privileged ports are &gt; 1023)</span>
  <span class="n">FLAG</span> <span class="o">=</span> <span class="nb">open</span>(<span class="s1">'flag.txt'</span>, <span class="s1">'r'</span>).<span class="n">read</span>().<span class="n">strip</span>().<span class="n">encode</span>()
  
  <span class="kn">def</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">flag_ct</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
      <span class="n">pt</span> <span class="o">=</span> <span class="s1">'null'</span>
      <span class="k">if</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ct</span> <span class="ow">!=</span> <span class="n">flag_ct</span><span class="p">:</span>
          <span class="n">pt</span> <span class="o">=</span> <span class="n">hexlify</span><span class="p">(</span><span class="n">l2b</span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)))</span>.<span class="n">decode</span>()
      <span class="k">return</span> <span class="n">pt</span>
  
  <span class="kn">def</span> <span class="n">gen_params</span><span class="p">():</span>
      <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
          <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
          <span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
          <span class="n">e</span> <span class="o">=</span> <span class="mi">0x10001</span>
          <span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
          <span class="k">if</span> <span class="n">gcd</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
              <span class="n">d</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
              <span class="k">break</span>
      <span class="k">return</span> <span class="n">n</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">d</span>
  
  <span class="kn">def</span> <span class="n">threading</span><span class="p">(</span><span class="n">conn</span><span class="p">):</span>
      <span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">gen_params</span><span class="p">()</span>
      <span class="n">flag_ct</span> <span class="o">=</span> <span class="n">pow</span><span class="p">(</span><span class="n">b2l</span><span class="p">(</span><span class="n">FLAG</span><span class="p">),</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(f<span class="si">"n: {n}\ne: {e}\nd: {d}"</span><span class="p">)</span>
      <span class="n">conn</span><span class="o">.</span><span class="n">sendall</span><span class="p">(f<span class="si">"n: {hex(n)}\ne: {hex(e)}\nflag_ct: {hex(flag_ct)}\n\n"</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
      <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
          <span class="n">conn</span><span class="o">.</span><span class="n">sendall</span><span class="p">(b<span class="si">'Gimme ct (hex): '</span><span class="p">)</span>
          <span class="k">try</span><span class="p">:</span>
              <span class="n">ct</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">).</span><span class="n">strip</span><span class="p">().</span><span class="n">decode</span><span class="p">(),</span> <span class="mi">16</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">Exception</span> <span class="kn">as</span> <span class="n">e</span><span class="p">:</span>
              <span class="n">conn</span><span class="o">.</span><span class="n">sendall</span><span class="p">(b<span class="si">'invalid ct'</span><span class="p">)</span>
              <span class="k">break</span>
          
          <span class="n">pt</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">flag_ct</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
          <span class="n">conn</span><span class="o">.</span><span class="n">sendall</span><span class="p">(f<span class="si">'result: {pt}\n\n'</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
  
      <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> 

  <span class="line"><span class="kd">if</span> <span class="nb">__name__</span> <span class="o">==</span> <span class="s1">"__main__"</span><span class="p">:</span></span>
  <span class="line"><span class="sd">    with</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span></span>
  <span class="line"><span class="sd">        s</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SO_REUSEADDR</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></span>
  <span class="line"><span class="sd">        s</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">))</span></span>
  <span class="line"><span class="sd">        s</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span></span>
  <span class="line"><span class="sd">        while</span> <span class="bp">True</span><span class="p">:</span></span>
  <span class="line"><span class="sd">            conn</span><span class="p">,</span> <span class="n">addr</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span></span>
  <span class="line"><span class="sd">            print</span><span class="p">(</span><span class="s1">f'new connection: {addr}'</span><span class="p">)</span></span>
  <span class="line"><span class="sd">            start_new_thread</span><span class="p">(</span><span class="n">threading</span><span class="p">,</span> <span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="p">))</span></span>
  <span class="line"><span class="sd">        s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
</code></pre></div>
<p>So, basically it provides N, e and c and gives us a chance to decipher something. But the flag directly cannot be deciphered. This is plain RSA so it the following flaw.</p>
<code>m1^e * m2^e ≡ (m1m2)^e (mod n)</code>
<p>So, m1^e is the ciphered flag and the code above checks for the m2 cipher isPrime() function, so we have to find a prime that satisfies these conditions. Here is the code:</p>
<p>At last we get the cipher that has to be sent.i.e., (m1m2)^e. Then the service decrypts this for us. So we finally end up with m1m2. m1 is the flag, so we simply do m1m2/m2 to get the flag.</p>

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python">
<span class="line"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span></span>
<span class="line"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span> <span class="kn">as</span> <span class="n">l2b</span><span class="p">,</span> <span class="n">bytes_to_long</span> <span class="kn">as</span> <span class="n">b2l</span><span class="p">,</span> <span class="n">getPrime</span><span class="p">,</span> <span class="n">isPrime</span><span class="p">,</span> <span class="n">inverse</span></span>
<span class="line"></span>
<span class="line"><span class="n">n</span> <span class="o">=</span> <span class="mi">0x7c60c7769c411fe882a246eae7a0303d45e80f3559e850479e0db7960048b4bb4432163d20a445eaa16bcecb05757915e1efa8965d8bf0e65bdc01fe7ea136e79eeea009a28089d5de0f2046f76c1b5cac0b3013897ba2800db88510a42990a35abe23b57879c4b7c179a1e3001fb204a0c17f764f7257cb96e7825bc472489af4a355c0881815f3b63d53bec1f794ea0603bdf7df8a52a808da2f877e85c71c1c991081d32ce9ac4ab509825d2bdeacd252960da9a981ed0d940b3c5a872cc41face6c34823b45946f9667b8f38d22951fe17350c8049d5ea72a6bf1548127d210ac2330fcb6ed862ab82302fcc4335d19257588910a8beebba5879c8c63d29</span></span>
<span class="line"><span class="n">e</span> <span class="o">=</span> <span class="mi">0x10001</span></span>
<span class="line"><span class="n">c</span> <span class="o">=</span> <span class="mi">0x6e1c336f218028b7fc0c7604cb8efbe0a1f2ec2d51efd4b230de4750974deb6d8ed385c27790cb3159c70282ce7f14fd93051929a935d4789078a37ee39168a92605a53d290f8496e142bb95ccb3d82c9ae3300ea6b6b5cf15856529fadeef102ddd09a360e356756a8e7e6f26d1e8a3b811c5c7215307aeadcc3d9959382675e8c2562fafb914e86a5a35a75ec7fe3a1b704a3c7322df7ae8659e816027eddc66a46cd58821bda266e55b22b4b3a118dc90593aaba137fe2bd976a20277d4fb608fec9cfa974d139fab3b16bba5694974c6e160eead05188415188b0f3ca376bef98d060e987ce76b232ffe1fa47350e1a9066b812ef258e05bf7a70a8d6f5a</span></span>
<span class="line"></span>
<span class="line"><span class="n">t</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="line"><span class="n">tosend</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="line"><span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3000</span><span class="p">):</span></span>
<span class="line">    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">n</span><span class="p">)))</span><span class="o">%</span><span class="n">n</span></span>
<span class="line">    <span class="k">if</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">a</span><span class="p">):</span></span>
<span class="line">        <span class="n">t</span> <span class="o">=</span> <span class="n">i</span></span>
<span class="line">        <span class="n">tosend</span> <span class="o">=</span> <span class="n">hex</span><span class="p">(</span><span class="n">a</span><span class="p">)</span></span>
<span class="line">        <span class="k">break</span></span>
<span class="line"><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></span>
<span class="line"><span class="nb">print</span><span class="p">(</span><span class="n">tosend</span><span class="p">)</span></span>
<span class="line"></span>
<span class="line"><span class="c1"># This is generated output from the service</span></span>
<span class="line"><span class="n">final</span> <span class="o">=</span> <span class="mi">0x03aafc896d25afdaea1c0f3ee6a719b7d42d357d4c7b60d42009de58007af1610251de366b0222e14afcada4a833d1e38f8acea3c5e39a9ac5fa</span></span>
<span class="line"></span>
<span class="line"><span class="n">final</span> <span class="o">=</span> <span class="n">final</span><span class="o">//</span><span class="n">t</span></span>
<span class="line"><span class="nb">print</span><span class="p">(</span><span class="n">l2b</span><span class="p">(</span><span class="n">final</span><span class="p">).</span><span class="n">decode</span><span class="p">())</span></span>
</code></pre></div>
<p>UMDCTF{s3lf_r3duc!bility_1s_n0t_ju5t_f0r_DH_97912837923}</p>

<h5>Noisy Bits</h5>
<p>This challenge had the description saying 'Go lay down', which refers to Golay code. It helped me solve the challenge.</p>
<p>This challenge provided a python code and an output file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python">
<span class="kd">import</span> <span class="nx">random</span>

<span class="nx">POLY</span> <span class="o">=</span> <span class="mi">0xC75</span>
<span class="nx">FLAG_BIN_LENGTH</span> <span class="o">=</span> <span class="mi">360</span>

<span class="kd">def</span> <span class="nf">encode</span><span class="p">(</span><span class="nx">cw</span><span class="p">):</span>
  <span class="nx">cw</span> <span class="o">=</span> <span class="p">(</span><span class="nx">cw</span> <span class="o">&amp;</span> <span class="mi">0xfff</span><span class="p">)</span>
  <span class="nx">c</span> <span class="o">=</span> <span class="nx">cw</span>
  <span class="k">for</span> <span class="nx">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="nx">cw</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
      <span class="nx">cw</span> <span class="o">=</span> <span class="nx">cw</span> <span class="o">^</span> <span class="nx">POLY</span>
    <span class="nx">cw</span> <span class="o">=</span> <span class="nx">cw</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>

  <span class="k">return</span> <span class="p">(</span><span class="nx">cw</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">|</span> <span class="nx">c</span>


<span class="nx">flag</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'crypto/Noisy Bits/flag.txt'</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">).</span><span class="nx">read</span><span class="p">()</span>

<span class="nx">binary_str</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">from_bytes</span><span class="p">(</span><span class="nx">flag</span><span class="p">,</span> <span class="s1">'big'</span><span class="p">)))</span><span class="o">[</span><span class="mi">2</span><span class="o">:]</span><span class="o">.</span><span class="nx">zfill</span><span class="p">(</span><span class="nx">FLAG_BIN_LENGTH</span><span class="p">)</span>

<span class="nx">blocks</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">''</span><span class="o">.</span><span class="nx">join</span><span class="p">([</span><span class="nx">binary_str</span><span class="p">[</span><span class="mi">12</span><span class="o">*</span><span class="nx">i</span><span class="o">+</span><span class="nx">j</span><span class="p">]</span> <span class="k">for</span> <span class="nx">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">)])</span> <span class="k">for</span> <span class="nx">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nx">FLAG_BIN_LENGTH</span> <span class="o">//</span> <span class="mi">12</span><span class="p">)])</span>

<span class="nb">print</span><span class="p">(</span><span class="nx">blocks</span><span class="p">)</span>
<span class="nx">block_nos</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">int</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="nx">s</span> <span class="ow">in</span> <span class="nx">blocks</span> <span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nx">block_nos</span><span class="p">)</span>

<span class="nx">encoded</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">encode</span><span class="p">(</span><span class="nx">cw</span><span class="p">)</span> <span class="k">for</span> <span class="nx">cw</span> <span class="ow">in</span> <span class="nx">block_nos</span> <span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nx">encoded</span><span class="p">)</span>

<span class="c1"># flip some bits for fun</span>
<span class="k">for</span> <span class="nx">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nx">encoded</span><span class="p">)):</span>
  <span class="nx">encoded</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">encoded</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="nx">random</span><span class="o">.</span><span class="nx">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">22</span><span class="p">))</span>
  <span class="nx">encoded</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">encoded</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="nx">random</span><span class="o">.</span><span class="nx">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">22</span><span class="p">))</span>
  <span class="nx">encoded</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">encoded</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="nx">random</span><span class="o">.</span><span class="nx">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">22</span><span class="p">))</span>

<span class="nx">encoded_bin</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">bin</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="o">[</span><span class="mi">2</span><span class="o">:]</span><span class="o">.</span><span class="nx">zfill</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="k">for</span> <span class="nx">e</span> <span class="ow">in</span> <span class="nx">encoded</span> <span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">' '.join(encoded_bin)</span><span class="p">)</span>
</code></pre></div>
<p>As each bit was flipped three times, I have used hamming distance &lt;= 3 to get the flag. Below is the code:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python">
<span class="nx">POLY</span> = <span class="nb">0xC75</span>

<span class="nx">codewords</span> = [<span class="p"># Output file</span>]

<span class="nx">def</span> <span class="np">golay</span>(cw):
  cw = (cw <span class="mi">&amp;</span> <span class="nb">0xfff</span>)
  c = cw
  <span class="nx">for</span> i <span class="nx">in</span> <span class="np">range</span>(<span class="nb">1</span>, <span class="nb">12</span>+<span class="nb">1</span>):
      <span class="nx">if</span> cw <span class="mi">&amp;</span> <span class="nb">1</span> != <span class="nb">0</span>:
          cw = cw <span class="mi">^</span> <span class="nx">POLY</span>
      cw = cw <span class="mi">&gt;&gt;</span> <span class="nb">1</span>

  <span class="nx">return</span> (cw <span class="mi">&lt;&lt;</span> <span class="nb">12</span>) <span class="mi">|</span> c

<span class="nx">def</span> <span class="np">hamming_dist</span>(x, y):
  s1 = bin(x)[<span class="nb">2</span>:].zfill(<span class="nb">23</span>)
  s2 = bin(y)[<span class="nb">2</span>:].zfill(<span class="nb">23</span>)
  <span class="nx">return</span> <span class="np">sum</span>(c1 != c2 <span class="nx">for</span> c1, c2 <span class="nx">in</span> <span class="np">zip</span>(s1, s2))

<span class="nx">valid_words</span> = {}
<span class="nx">for</span> i <span class="nx">in</span> <span class="np">range</span>(<span class="nb">0</span>, <span class="nb">2</span>**<span class="nb">12</span>):
  valid_words[golay(i)] = i

flag_binary = ''
<span class="nx">for</span> cw <span class="nx">in</span> codewords:
  <span class="nx">for</span> k <span class="nx">in</span> valid_words.keys():
      <span class="nx">if</span> hamming_dist(cw, k) <span class="mi">&lt;=</span> <span class="nb">3</span>:
          flag_binary += bin(valid_words[k])[<span class="nb">2</span>:].zfill(<span class="nb">12</span>)
flag = ''
<span class="nx">for</span> bit <span class="nx">in</span> flag_binary:
  <span class="nx">if</span> <span class="nb">len</span>(flag) <span class="mi">==</span> <span class="nb">8</span>:
      <span class="nx">print</span>(<span class="nx">chr</span>(<span class="nb">int</span>(flag, <span class="nb">2</span>)), <span class="nx">end</span> = '')
      flag = ''
  flag += bit
</code></pre></div>

<p>UMDCTF{n0i5y_ch4nn3l5_ar3_n0t_@_pr0bleM_4_u}</p>


</div><hr /><div class="post-navs d-flex mb-3 justify-content-evenly">
  <div class="post-nav post-prev"><i class="fas fa-fw fa-chevron-left"></i>
    <a href="https://farmansk.github.io/posts/invaderctf-writeups/">InvaderCTF Writeups
</a>
  </div></div><section class="related-posts-wrapper">
    <h3>Related Posts</h3>
    <ul class="related-posts"><li><a href="https://farmansk.github.io/posts/invaderctf-writeups/">InvaderCTF Writeups
</a></li><li><a href="https://farmansk.github.io/about/">About
</a></li></ul>
  </section></div>
    </article></div>
</div><aside class="col-lg-4 sidebar d-flex">
  <div class="container">
    
    <section class="card row text-center profile component">
  <div class="card-body">
    <div class="col-12 d-flex align-items-center justify-content-center"><img class="profile-avatar rounded-circle" alt="Farman Shaik" src="https://farmansk.github.io/images/me.jpg" loading="lazy"
  
   />
</div>
    <div class="col-12 profile-meta"><div class="profile-name">Farman Shaik</div><div class="profile-bio"> Intrested about WEB 3.0 and Block Chain technologies</div><div class="profile-company"><i class="fas fa-fw fa-building"></i> ...</div><br /><div class="profile-location"><i class="fas fa-fw fa-map-marker-alt"></i> India</div><br /><div class="profile-about"><i class="fas fa-fw fa-user"></i><a href="https://farmansk.github.io/about/"> About Me</a></div><br /></div>
  </div>
</section>
  <section class="recent-posts row card component">
  <div class="card-body">
    <h2 class="card-title">Recent Posts</h2>
    <ul><li><a href="https://farmansk.github.io/posts/n00bz2023/">n00bz CTF
    </a></li><li><a href="https://farmansk.github.io/posts/umdctf2023/">UMDCTF 2023
    </a></li><li><a href="https://farmansk.github.io/posts/csaw_quals_2022/">CSAW Quals 2022
</a></li><li><a href="https://farmansk.github.io/posts/invaderctf-writeups/">InvaderCTF Writeups
</a></li></ul>
  </div>
</section><section class="taxonomies row card component">
      <div class="card-body">
        <h2 class="card-title">
          <a href="https://farmansk.github.io/categories">Categories</a>
        </h2>
        <div><a href="https://farmansk.github.io/categories/ctf/" class="badge bg-primary text-white rounded post-taxonomy" title="CTF">
            CTF
          </a><a href="https://farmansk.github.io/categories/security/" class="badge bg-primary text-white rounded post-taxonomy" title="Security">
            Security
          </a><a href="https://farmansk.github.io/categories/writeups/" class="badge bg-primary text-white rounded post-taxonomy" title="WriteUps">
            WriteUps
          </a></div>
      </div>
    </section><section class="taxonomies row card component">
      <div class="card-body">
        <h2 class="card-title">
          <a href="https://farmansk.github.io/tags">Tags</a>
        </h2>
        <div><a href="https://farmansk.github.io/tags/misc/" class="badge bg-primary text-white rounded post-taxonomy" title="Misc">
            Misc
          </a><a href="https://farmansk.github.io/tags/crypto/" class="badge bg-primary text-white rounded post-taxonomy" title="Crypto">
            Crypto
          </a></div>
      </div>
    </section>
    
  </div>
</aside>
</div>
    </main><footer class="footer mt-auto py-3 text-center container"><nav class="social-links nav my-2 justify-content-center">
      <a class="nav-link social-link" href="mailto:x0rc1ph3r@gmail.com" title="Email">
      <i class="fas fa-fw fa-2x fa-envelope"></i>
    </a><a class="nav-link social-link" target="_blank" href="https://github.com/farmansk" title="GitHub" rel="noopener noreferrer">
        <i class="fa-fw fa-2x fab fa-github"></i>
      </a><a class="nav-link social-link" target="_blank" href="https://www.linkedin.com/in/farman-shaik-b699a8241" title="LinkedIn" rel="noopener noreferrer">
        <i class="fa-fw fa-2x fab fa-linkedin-in"></i>
      </a><a class="nav-link social-link" target="_blank" href="https://twitter.com/FarmanShaik4" title="Twitter" rel="noopener noreferrer">
        <i class="fa-fw fa-2x fab fa-twitter"></i>
      </a><a class="nav-link social-link" target="_blank" href="https://farmansk.github.io/farman" title="Website"
      rel="noopener noreferrer"><i class="fas fa-fw fa-2x fa-link"></i>
      </a></nav>
<div class="copyright mb-2">
  Copyright © 2022 Farman Shaik. All Rights Reserved.
</div>
</footer>
<script src="https://farmansk.github.io/js/bundle.min.dfff1fab09c570894e719d1447ee731c8bb5a1e57e18d45beff274823da322f0.js" integrity="sha256-3/8fqwnFcIlOcZ0UR&#43;5zHIu1oeV&#43;GNRb7/J0gj2jIvA=" crossorigin="anonymous" defer></script><script defer src="https://farmansk.github.io/js/viewer.min.2b366f6cb186c9ce6e41936589e36005bc87d36452602e9aea75f196009e8b95.js" integrity="sha256-KzZvbLGGyc5uQZNlieNgBbyH02RSYC6a6nXxlgCei5U=" crossorigin="anonymous"></script><script defer src="https://farmansk.github.io/js/katex.min.affcdb0c3de1260e0074ae86bffee9280f85eb73debefdce021e5d030c262a17.js" integrity="sha256-r/zbDD3hJg4AdK6Gv/7pKA&#43;F63Pevv3OAh5dAwwmKhc=" crossorigin="anonymous"></script>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-213801925-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>
</html>